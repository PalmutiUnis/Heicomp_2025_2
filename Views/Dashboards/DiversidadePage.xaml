<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:micro="clr-namespace:Microcharts.Maui;assembly=Microcharts.Maui"
             xmlns:converters="clr-namespace:MauiApp1.Converters"
             x:Class="MauiApp1.Views.Dashboards.DiversidadePage"
             Title=""
             BackgroundColor="{AppThemeBinding Light={StaticResource FundoPaginaClaro}, 
                                               Dark={StaticResource FundoPaginaEscuro}}"
             Shell.FlyoutBehavior="Disabled">

    <Shell.TitleView>
        <Grid ColumnDefinitions="*, Auto">
            <Label Text="Indicadores de Diversidade" TextColor="White" FontSize="18" FontAttributes="Bold" VerticalOptions="Center"/>
            <ImageButton Grid.Column="1" Source="icone_menu.png" HeightRequest="24" WidthRequest="24" Margin="0,0,10,0" BackgroundColor="Transparent"/>
        </Grid>
    </Shell.TitleView>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="15">

            <!-- Título da Página -->
            <Label Text="Indicadores de Diversidade"
                   Style="{StaticResource TextoTituloSecao}"
                   TextColor="{AppThemeBinding Light={StaticResource TextoPrincipalClaro}, Dark={StaticResource TextoPrincipalEscuro}}"/>

            <!-- Picker de Ano -->
            <Picker x:Name="pickerAno"
                    Title="Selecione o ano"
                    HorizontalOptions="Fill"
                    BackgroundColor="{AppThemeBinding Light={StaticResource FundoCardClaro},
                                                      Dark={StaticResource FundoCardEscuro}}"
                    FontSize="14"
                    HeightRequest="40"
                    TitleColor="{AppThemeBinding Light={StaticResource CorTextoCinza},
                                                 Dark={StaticResource CorTextoCinza}}"
                    TextColor="{AppThemeBinding Light={StaticResource CorTextoPreto},
                                                Dark={StaticResource CorTextoBranco}}">
                <Picker.ItemsSource>
                    <x:Array Type="{x:Type x:String}">
                        <x:String>2022</x:String>
                        <x:String>2023</x:String>
                        <x:String>2024</x:String>
                        <x:String>2025</x:String>
                    </x:Array>
                </Picker.ItemsSource>
            </Picker>

            <!-- Seção de porcentagens gerais -->
            <Label Text="Porcentagens gerais"
                   Style="{StaticResource TextoTituloSecao}"
                   TextColor="{AppThemeBinding Light={StaticResource TextoPrincipalClaro}, Dark={StaticResource TextoPrincipalEscuro}}"/>

            <!-- Grade de Cards -->
            <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="10" RowSpacing="10">

                <!-- Total Colaboradores -->
                <Border Grid.Row="0" Grid.Column="0"
                        Style="{StaticResource CardPadrao}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource FundoPaginaClaro}, Dark={StaticResource FundoCardEscuro}}"
                        Padding="12"
                        HeightRequest="100">
                    <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
                        <Image Grid.Row="0"
                               Source="icone_organizacao.png"
                               HeightRequest="24"
                               WidthRequest="24"
                               HorizontalOptions="Start"
                               Margin="0,0,0,5" />
                        <VerticalStackLayout Grid.Column="1"
                                             Padding="10,0,0,0"
                                             VerticalOptions="Center"
                                             Spacing="2">
                            <Label Text="1,247"
                                   FontAttributes="Bold"
                                   FontSize="22"
                                   TextColor="{AppThemeBinding Light={StaticResource HeaderClaro},
                                                               Dark={StaticResource HeaderClaro}}"/>
                            <Label Text="Total Colaboradores"
                                   FontSize="13"
                                   TextColor="{AppThemeBinding Light={StaticResource CorTextoCinza}, Dark={StaticResource CorTextoCinza}}"/>
                        </VerticalStackLayout>
                    </Grid>
                </Border>

                <!-- Homens -->
                <Border Grid.Row="0" Grid.Column="1"
                        Style="{StaticResource CardPadrao}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource FundoPaginaClaro}, Dark={StaticResource FundoCardEscuro}}"
                        Padding="12"
                        HeightRequest="100">
                    <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
                        <Image Grid.Row="0"
                               Source="icone_masculino.png"
                               HeightRequest="24"
                               WidthRequest="24"
                               HorizontalOptions="Start"
                               Margin="0,0,0,5" />
                        <VerticalStackLayout Grid.Column="1"
                                             Padding="10,0,0,0"
                                             VerticalOptions="Center"
                                             Spacing="2">
                            <Label Text="58.2%"
                                   FontAttributes="Bold"
                                   FontSize="22"
                                   TextColor="{AppThemeBinding Light={StaticResource TextoAzulClaro},
                                                               Dark={StaticResource TextoAzulEscuro}}"/>
                            <Label Text="Homens"
                                   FontSize="13"
                                   TextColor="{AppThemeBinding Light={StaticResource CorTextoCinza}, Dark={StaticResource CorTextoCinza}}"/>
                        </VerticalStackLayout>
                    </Grid>
                </Border>

                <!-- Mulheres -->
                <Border Grid.Row="1" Grid.Column="0"
                        Style="{StaticResource CardPadrao}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource FundoPaginaClaro}, Dark={StaticResource FundoCardEscuro}}"
                        Padding="12"
                        HeightRequest="100">
                    <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
                        <Image Grid.Row="0"
                               Source="icone_feminino.png"
                               HeightRequest="24"
                               WidthRequest="24"
                               HorizontalOptions="Start"
                               Margin="0,0,0,5" />
                        <VerticalStackLayout Grid.Column="1"
                                             Padding="10,0,0,0"
                                             VerticalOptions="Center"
                                             Spacing="2">
                            <Label Text="40.1%"
                                   FontAttributes="Bold"
                                   FontSize="22"
                                   TextColor="{AppThemeBinding Light={StaticResource ProgressMulher},
                                                               Dark={StaticResource ProgressMulher}}"/>
                            <Label Text="Mulheres"
                                   FontSize="13"
                                   TextColor="{AppThemeBinding Light={StaticResource CorTextoCinza}, Dark={StaticResource CorTextoCinza}}"/>
                        </VerticalStackLayout>
                    </Grid>
                </Border>

                <!-- Não Informado -->
                <Border Grid.Row="1" Grid.Column="1"
                        Style="{StaticResource CardPadrao}"
                        BackgroundColor="{AppThemeBinding Light={StaticResource FundoPaginaClaro}, Dark={StaticResource FundoCardEscuro}}"
                        Padding="12"
                        HeightRequest="100">
                    <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
                        <Image Grid.Row="0"
                               Source="icone_interrogacao.png"
                               HeightRequest="24"
                               WidthRequest="24"
                               HorizontalOptions="Start"
                               Margin="0,0,0,5" />
                        <VerticalStackLayout Grid.Column="1"
                                             Padding="10,0,0,0"
                                             VerticalOptions="Center"
                                             Spacing="2">
                            <Label Text="1.7%"
                                   FontAttributes="Bold"
                                   FontSize="22"
                                   TextColor="{AppThemeBinding Light={StaticResource ProgressNF},
                                                               Dark={StaticResource ProgressNF}}"/>
                            <Label Text="Não Informado"
                                   FontSize="13"
                                   TextColor="{AppThemeBinding Light={StaticResource CorTextoCinza}, Dark={StaticResource CorTextoCinza}}"/>
                        </VerticalStackLayout>
                    </Grid>
                </Border>

            </Grid>

            <Frame CornerRadius="12" Padding="20" HasShadow="True" BorderColor="Transparent" BackgroundColor="White">
                <VerticalStackLayout Spacing="10">

                    <!-- Cabeçalho com ícone e texto -->
                    <Grid ColumnDefinitions="Auto,*" VerticalOptions="Center">
                        <Image Source="fundo_genero.png"
                   HeightRequest="22"
                   WidthRequest="22"
                   HorizontalOptions="Start"
                   VerticalOptions="Center"/>

                        <Label Grid.Column="1"
                   Text="Distribuição por Gênero"
                   FontAttributes="Bold"
                   FontSize="18"
                   TextColor="{AppThemeBinding Light={StaticResource AzulTemaClaro}, Dark={StaticResource TextoPrincipalEscuro}}"
                   VerticalOptions="Center"
                   Margin="8,0,0,0"/>
                    </Grid>

                    <!-- Espaço reservado para o gráfico -->
                    <Grid HeightRequest="180"
              VerticalOptions="CenterAndExpand"
              HorizontalOptions="Center"
              BackgroundColor="Transparent"
              Padding="0,10,0,0">

                        <!-- Aqui entrará o componente de gráfico futuramente -->
                        <Label Text="(Gráfico aqui)"
                   FontSize="14"
                   TextColor="{AppThemeBinding Light={StaticResource CorTextoCinza}, Dark={StaticResource CorTextoBranco}}"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"/>
                    </Grid>

                    <micro:ChartView Chart="{Binding ChartGenero}" 
                                     HeightRequest="350" 
                                     BackgroundColor="Transparent"/>
                </VerticalStackLayout>
            </Frame>

            <Frame CornerRadius="12" Padding="20" HasShadow="True" BorderColor="Transparent" BackgroundColor="White">
                <VerticalStackLayout Spacing="15">

                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Image Source="icone_alteraracoes.png" HeightRequest="24" WidthRequest="24" VerticalOptions="Center"/>
                        <Label Text="Raça/Cor" TextColor="#1E3A8A" FontAttributes="Bold" FontSize="16" VerticalOptions="Center"/>
                    </HorizontalStackLayout>

                    <CollectionView ItemsSource="{Binding DistribuicoesRaca}">
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="100, *" Padding="0,6">
                                    <Label Grid.Column="0" Text="{Binding Descricao}" FontSize="13" TextColor="#374151" VerticalOptions="Center" HorizontalOptions="End" Margin="0,0,10,0"/>

                                    <Grid Grid.Column="1" ColumnDefinitions="Auto, Auto">
                                        <Frame Grid.Column="0" BackgroundColor="#1E3A8A" CornerRadius="4" HeightRequest="18" 
                                               WidthRequest="{Binding Percentual, Converter={StaticResource PercentToWidthConverter}}"
                                               Padding="0" HasShadow="False" HorizontalOptions="Start"/>
                                        <Label Grid.Column="1" Text="{Binding Percentual, StringFormat='{0:F1}%'}" TextColor="#1E3A8A" FontSize="12" FontAttributes="Bold" VerticalOptions="Center" Margin="8,0,0,0"/>
                                    </Grid>
                                </Grid>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>
            </Frame>

            <Frame CornerRadius="12" Padding="20" HasShadow="True" BorderColor="Transparent" BackgroundColor="White">
                <VerticalStackLayout Spacing="15">

                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Image Source="icone_acessibilidade_claro.png" HeightRequest="24" WidthRequest="24" VerticalOptions="Center"/>
                        <Label Text="Pessoas com Deficiência" TextColor="#1E3A8A" FontAttributes="Bold" FontSize="16" VerticalOptions="Center"/>
                    </HorizontalStackLayout>

                    <Grid ColumnDefinitions="40, *" HeightRequest="220">
                        <VerticalStackLayout Grid.Column="0" VerticalOptions="Fill" Spacing="0">
                            <Label Text="100" FontSize="11" TextColor="#9CA3AF" VerticalOptions="Start"/>
                            <Label Text="50" FontSize="11" TextColor="#9CA3AF" VerticalOptions="CenterAndExpand"/>
                            <Label Text="0" FontSize="11" TextColor="#9CA3AF" VerticalOptions="End"/>
                        </VerticalStackLayout>
                        <StackLayout Grid.Column="1" VerticalOptions="Fill" Spacing="0">
                            <BoxView HeightRequest="1" Color="#F3F4F6" VerticalOptions="Start"/>
                            <BoxView HeightRequest="1" Color="#F3F4F6" VerticalOptions="CenterAndExpand"/>
                            <BoxView HeightRequest="1" Color="#9CA3AF" VerticalOptions="End"/>
                        </StackLayout>
                        <CollectionView Grid.Column="1" ItemsSource="{Binding DistribuicoesPCD}" ItemsLayout="HorizontalList" VerticalOptions="End" HeightRequest="200" Margin="20,0,0,0">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <VerticalStackLayout VerticalOptions="End" Spacing="5" WidthRequest="100">
                                        <Label Text="{Binding Percentual, StringFormat='{0:F1}%'}" TextColor="#1E3A8A" FontSize="12" FontAttributes="Bold" HorizontalOptions="Center"/>
                                        <Frame CornerRadius="4" HasShadow="False" Padding="0" BackgroundColor="#1E3A8A" WidthRequest="60" HorizontalOptions="Center" HeightRequest="{Binding Percentual, Converter={StaticResource PercentToHeightConverter}}"/>
                                        <Label Text="{Binding Descricao}" TextColor="#374151" FontSize="12" HorizontalTextAlignment="Center" HorizontalOptions="Center"/>
                                    </VerticalStackLayout>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>
                    </Grid>
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>